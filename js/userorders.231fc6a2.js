(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["userorders"],{"3a33":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"userorder"}},[a("h1",{staticClass:"management-title"},[t._v("等待回應中")]),a("div",{staticClass:"order-container"},[a("b-table",{attrs:{data:t.orders,striped:!0,hoverable:!0},scopedSlots:t._u([{key:"empty",fn:function(){return[a("div",{staticClass:"has-text-centered"},[t._v("沒有委託紀錄")])]},proxy:!0}])},[a("b-table-column",{attrs:{label:"創作者",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{staticClass:"link",attrs:{to:"/member/"+e.row.illustrator._id}},[a("div",{staticClass:"user-headshot"},[a("img",{attrs:{src:e.row.illustrator.headshot}})]),a("span",[t._v(t._s(e.row.illustrator.nickname))])])]}}])}),a("b-table-column",{attrs:{label:"委託項目",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{staticClass:"link",attrs:{to:"/products/"+e.row.product._id}},[a("span",[t._v(t._s(e.row.product.name))])])]}}])}),a("b-table-column",{attrs:{label:"委託時間",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(new Date(e.row.date).toLocaleString("zh-tw")))])]}}])}),a("b-table-column",{attrs:{label:"委託單內容"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b-button",{staticClass:"edit",on:{click:function(a){return t.openContent(e.index)}}},[a("b-icon",{attrs:{pack:"fas",icon:"envelope"}})],1)]}}])})],1)],1),a("h1",{staticClass:"management-title"},[t._v("正在進行中")]),a("div",{staticClass:"order-container"},[a("b-table",{attrs:{data:t.accept,striped:!0,hoverable:!0},scopedSlots:t._u([{key:"empty",fn:function(){return[a("div",{staticClass:"has-text-centered"},[t._v("沒有委託紀錄")])]},proxy:!0}])},[a("b-table-column",{attrs:{label:"創作者",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{staticClass:"link",attrs:{to:"/member/"+e.row.illustrator._id}},[a("div",{staticClass:"user-headshot"},[a("img",{attrs:{src:e.row.illustrator.headshot}})]),a("span",[t._v(t._s(e.row.illustrator.nickname))])])]}}])}),a("b-table-column",{attrs:{label:"委託項目",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{staticClass:"link",attrs:{to:"/products/"+e.row.product._id}},[a("span",[t._v(t._s(e.row.product.name))])])]}}])}),a("b-table-column",{attrs:{label:"委託時間",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(new Date(e.row.date).toLocaleString("zh-tw")))])]}}])}),a("b-table-column",{attrs:{label:"委託單內容"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b-button",{staticClass:"edit",on:{click:function(a){return t.openAccept(e.index)}}},[a("b-icon",{attrs:{pack:"fas",icon:"envelope"}})],1)]}}])}),a("b-table-column",{attrs:{label:"匯款方式"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b-button",{staticClass:"edit blue",on:{click:function(a){return t.openPayment(e.index)}}},[a("b-icon",{attrs:{pack:"fas",icon:"envelope"}})],1)]}}])})],1)],1),a("h1",{staticClass:"management-title"},[t._v("完成的委託")]),a("div",{staticClass:"order-container"},[a("b-table",{ref:"table",attrs:{data:t.finished,striped:!0,hoverable:!0},scopedSlots:t._u([{key:"empty",fn:function(){return[a("div",{staticClass:"has-text-centered"},[t._v("沒有委託紀錄")])]},proxy:!0}])},[a("b-table-column",{attrs:{label:"創作者",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{staticClass:"link",attrs:{to:"/member/"+e.row.illustrator._id}},[a("div",{staticClass:"user-headshot"},[a("img",{attrs:{src:e.row.illustrator.headshot}})]),a("span",[t._v(t._s(e.row.illustrator.nickname))])])]}}])}),a("b-table-column",{attrs:{label:"委託項目",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{staticClass:"link",attrs:{to:"/products/"+e.row.product._id}},[a("span",[t._v(t._s(e.row.product.name))])])]}}])}),a("b-table-column",{attrs:{label:"委託時間",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(new Date(e.row.date).toLocaleString("zh-tw")))])]}}])}),a("b-table-column",{attrs:{label:"委託單內容"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b-button",{staticClass:"edit",on:{click:function(a){return t.openFinish(e.index)}}},[a("b-icon",{attrs:{pack:"fas",icon:"envelope"}})],1)]}}])}),a("b-table-column",{attrs:{label:"評價/評論"},scopedSlots:t._u([{key:"default",fn:function(e){return[void 0===e.row.star&&void 0===e.row.review?a("b-button",{staticClass:"is-success",on:{click:function(a){return t.create(e.index)}}},[t._v("新增")]):t._e(),void 0!==e.row.star&&void 0!==e.row.review?a("b-button",{staticClass:"edit blue",on:{click:function(a){return t.openReview(e.index)}}},[a("b-icon",{attrs:{pack:"fas",icon:"envelope"}})],1):t._e()]}}])})],1)],1),a("h1",{staticClass:"management-title"},[t._v("被取消的委託")]),a("div",{staticClass:"order-container"},[a("b-table",{attrs:{data:t.cancel,striped:!0,hoverable:!0},scopedSlots:t._u([{key:"empty",fn:function(){return[a("div",{staticClass:"has-text-centered"},[t._v("沒有委託紀錄")])]},proxy:!0}])},[a("b-table-column",{attrs:{label:"創作者",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{staticClass:"link",attrs:{to:"/member/"+e.row.illustrator._id}},[a("div",{staticClass:"user-headshot"},[a("img",{attrs:{src:e.row.illustrator.headshot}})]),a("span",[t._v(t._s(e.row.illustrator.nickname))])])]}}])}),a("b-table-column",{attrs:{label:"委託項目",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{staticClass:"link",attrs:{to:"/products/"+e.row.product._id}},[a("span",[t._v(t._s(e.row.product.name))])])]}}])}),a("b-table-column",{attrs:{label:"委託時間",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(new Date(e.row.date).toLocaleString("zh-tw")))])]}}])}),a("b-table-column",{attrs:{label:"委託單內容"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b-button",{staticClass:"edit",on:{click:function(a){return t.openCancel(e.index)}}},[a("b-icon",{attrs:{pack:"fas",icon:"envelope"}})],1)]}}])}),a("b-table-column",{attrs:{label:"取消原因"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.reason))])]}}])})],1)],1),a("b-modal",{attrs:{width:"700px",scroll:"keep"},model:{value:t.openModal,callback:function(e){t.openModal=e},expression:"openModal"}},[a("div",{staticClass:"normal-form"},[a("div",{staticClass:"modal-red"},[a("h1",[t._v("委託單內容")])]),a("div",{staticClass:"modal-white"},[a("div",{staticClass:"modal-items"},[a("div",{staticClass:"modal-item"},[a("h3",[t._v("✦ 需求描述")]),a("p",[t._v(t._s(t.modal.description))])]),a("div",{staticClass:"modal-item"},[a("h3",[t._v("✦ 參考圖")]),t._l(t.modal.images,(function(t){return a("div",{key:t,staticClass:"modal-images"},[a("img",{attrs:{src:t}})])}))],2),a("div",{staticClass:"modal-item"},[a("h3",[t._v("✦ 參考資料來源")]),a("p",[t._v(t._s(t.modal.source))])])])])])]),a("b-modal",{attrs:{width:"700px",scroll:"keep"},model:{value:t.openPaymentModal,callback:function(e){t.openPaymentModal=e},expression:"openPaymentModal"}},[a("div",{staticClass:"normal-form"},[a("div",{staticClass:"modal-red"},[a("h1",[t._v("匯款方式")])]),a("div",{staticClass:"modal-white"},[a("div",{staticClass:"modal-items"},[a("div",{staticClass:"modal-item"},[a("p",[t._v(t._s(t.payment))])])])])])]),a("b-modal",{attrs:{width:"700px",scroll:"keep"},model:{value:t.openReviewModal,callback:function(e){t.openReviewModal=e},expression:"openReviewModal"}},[a("div",{staticClass:"normal-form"},[a("div",{staticClass:"modal-red"},[a("h1",[t._v("評價/評論")])]),a("div",{staticClass:"modal-white"},[a("div",{staticClass:"modal-items"},[a("div",{staticClass:"modal-item"},[a("h3",[t._v("✦ 評價")]),a("b-rate",{attrs:{max:5,disabled:!0},model:{value:t.form1.star,callback:function(e){t.$set(t.form1,"star",e)},expression:"form1.star"}})],1),a("div",{staticClass:"modal-item"},[a("h3",[t._v("✦ 評論")]),a("p",[t._v(t._s(t.form1.review))])])])])])]),a("b-modal",{attrs:{width:"700px",scroll:"keep"},on:{close:t.resetReviewModal},model:{value:t.reviewModal,callback:function(e){t.reviewModal=e},expression:"reviewModal"}},[a("div",{staticClass:"normal-form"},[a("div",{staticClass:"modal-red"},[a("h1",[t._v("新增評價和評論")])]),a("div",{staticClass:"modal-white"},[a("form",{staticClass:"form-group",on:{submit:function(e){return e.preventDefault(),t.submitReviewModal.apply(null,arguments)}}},[a("b-field",{attrs:{label:"✦ 評價"}},[a("b-rate",{attrs:{max:5},model:{value:t.form.star,callback:function(e){t.$set(t.form,"star",e)},expression:"form.star"}})],1),a("b-field",{attrs:{label:"✦ 評論"}},[a("b-input",{attrs:{placeholder:"請輸入評論",type:"textarea"},model:{value:t.form.review,callback:function(e){t.$set(t.form,"review",e)},expression:"form.review"}})],1),a("div",{staticClass:"buttons"},[a("b-button",{staticClass:"is-dark",attrs:{disabled:t.modalSubmitting},on:{click:t.resetReviewModal}},[t._v("取消")]),a("input",{staticClass:"button is-success submit",attrs:{type:"submit",value:"送出",disabled:t.modalSubmitting}})],1)],1)])])])],1)},r=[],o=a("5530"),n=a("1da1"),i=(a("96cf"),{data:function(){return{openModal:!1,openPaymentModal:!1,openReviewModal:!1,reviewModal:!1,modalSubmitting:!1,orders:[],accept:[],cancel:[],finished:[],modal:{description:"",images:[],source:""},payment:"",form:{star:"",review:"",_id:"",index:-1},form1:{star:"",review:""}}},methods:{submitReviewModal:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.preventDefault(),0!==e.form.star.length||0!==e.form.star.review){a.next=4;break}return e.$swal({icon:"error",title:"錯誤",text:"請輸入評價/評論"}),a.abrupt("return");case 4:return e.modalSubmitting=!0,a.prev=5,a.next=8,e.api.patch("/orders/review/"+e.form._id,{star:e.form.star,review:e.form.review},{headers:{authorization:"Bearer "+e.user.token}});case 8:s=a.sent,r=s.data,e.finished[e.form.index]=r.result,e.$refs.table.resetMultiSorting(),e.$swal({icon:"success",title:"成功",text:"新增成功"}),a.next=18;break;case 15:a.prev=15,a.t0=a["catch"](5),e.$swal({icon:"error",title:"錯誤",text:"送出失敗"});case 18:e.modalSubmitting=!1,e.reviewModal=!1;case 20:case"end":return a.stop()}}),a,null,[[5,15]])})))()},openContent:function(t){this.modal=Object(o["a"])({},this.orders[t]),this.openModal=!0},openAccept:function(t){this.modal=Object(o["a"])({},this.accept[t]),this.openModal=!0},openPayment:function(t){this.payment=this.accept[t].payment,this.openPaymentModal=!0},openFinish:function(t){this.modal=Object(o["a"])({},this.finished[t]),this.openModal=!0},openCancel:function(t){this.modal=Object(o["a"])({},this.cancel[t]),this.openModal=!0},openReview:function(t){this.form1=Object(o["a"])({},this.finished[t]),this.openReviewModal=!0},create:function(t){this.form._id=this.finished[t]._id,this.form.index=t,this.reviewModal=!0},resetReviewModal:function(t){this.modalSubmitting?t.preventDefault():(this.form={star:"",review:"",_id:"",index:-1},this.reviewModal=!1)}},created:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,s,r,o,n,i,l,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.user.token.length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,t.api.get("/orders/me",{headers:{authorization:"Bearer "+t.user.token}});case 5:return a=e.sent,s=a.data,t.orders=s.result,e.next=10,t.api.get("/orders/me/accept",{headers:{authorization:"Bearer "+t.user.token}});case 10:return r=e.sent,o=r.data,t.accept=o.result,e.next=15,t.api.get("/orders/me/cancel",{headers:{authorization:"Bearer "+t.user.token}});case 15:return n=e.sent,i=n.data,t.cancel=i.result,e.next=20,t.api.get("/orders/me/finished",{headers:{authorization:"Bearer "+t.user.token}});case 20:l=e.sent,c=l.data,t.finished=c.result,e.next=28;break;case 25:e.prev=25,e.t0=e["catch"](2),t.$swal({icon:"error",title:"錯誤",text:"取得資料失敗"});case 28:case"end":return e.stop()}}),e,null,[[2,25]])})))()}}),l=i,c=a("2877"),d=Object(c["a"])(l,s,r,!1,null,null,null);e["default"]=d.exports}}]);
//# sourceMappingURL=userorders.231fc6a2.js.map