(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["usermyinfo"],{"1c8c":function(e,t,a){e.exports=a.p+"img/facebook-square-brands.fc8432aa.svg"},"2baa":function(e,t,a){e.exports=a.p+"img/pixiv.1cc0b112.svg"},8380:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"usermyinfo"}},[r("h1",{staticClass:"management-title"},[e._v("基本資料")]),r("b-tabs",[r("b-tab-item",{attrs:{label:"帳號"}},[r("div",{staticClass:"myinfo-container"},[r("form",{staticClass:"form",on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[r("b-field",{attrs:{label:"✦ 暱稱","label-for":"illustrator-nickname",message:"最多可輸入 10 個字"}},[r("b-input",{attrs:{id:"illustrator-nickname",placeholder:"請輸入暱稱",maxlength:"10"},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),r("b-field",{attrs:{label:"✦ 大頭貼設定","label-for":"illustrator-headshot"}},[r("b-upload",{attrs:{id:"illustrator-headshot","drag-drop":"",expanded:""},model:{value:e.form.image,callback:function(t){e.$set(e.form,"image",t)},expression:"form.image"}},[r("section",{staticClass:"section"},[r("div",{staticClass:"content has-text-centered"},[r("p",[r("b-icon",{attrs:{icon:"upload",size:"is-large"}})],1),r("p",[e._v(" 點選或拖曳上傳圖片"),r("br")])])])])],1),e.form.image?r("span",{staticClass:"tag is-primary"},[e._v(e._s(e.form.image.name))]):e._e(),r("b-field",{attrs:{label:"✦ 自我介紹","label-for":"illustrator-selfIntroduction"}},[r("b-input",{attrs:{id:"illustrator-selfIntroduction",type:"textarea"},model:{value:e.form.selfIntroduction,callback:function(t){e.$set(e.form,"selfIntroduction",t)},expression:"form.selfIntroduction"}})],1),r("input",{staticClass:"button is-success submit",attrs:{type:"submit",value:"儲存設定",disabled:e.submitting}})],1),r("div",{staticClass:"title-plus"},[r("h1",{staticClass:"management-title"},[e._v("社群媒體")]),r("b-button",{staticClass:"is-success",on:{click:function(t){e.openModal=!0}}},[e._v("新增")])],1),r("b-table",{ref:"table",attrs:{data:e.websites,striped:!0,hoverable:!0},scopedSlots:e._u([{key:"empty",fn:function(){return[r("div",{staticClass:"has-text-centered"},[e._v("請新增社群媒體")])]},proxy:!0}])},[r("b-table-column",{attrs:{width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"website-category"},["個人網站"===t.row.category?r("b-icon",{attrs:{pack:"fas",icon:"house-user"}}):e._e(),"Facebook"===t.row.category?r("img",{staticClass:"svg",attrs:{src:a("1c8c")}}):e._e(),"Plurk"===t.row.category?r("img",{staticClass:"svg",attrs:{src:a("a3df")}}):e._e(),"Twitter"===t.row.category?r("img",{staticClass:"svg",attrs:{src:a("b1b8")}}):e._e(),"pixiv"===t.row.category?r("img",{staticClass:"svg",attrs:{src:a("2baa")}}):e._e(),"email"===t.row.category?r("b-icon",{attrs:{pack:"fas",icon:"envelope"}}):e._e(),"其他"===t.row.category?r("b-icon",{attrs:{pack:"fas",icon:"link"}}):e._e(),r("span",{staticClass:"website-name"},[e._v(e._s(t.row.category))])],1)]}}])}),r("b-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticClass:"my-website"},[e._v(e._s(t.row.website))])]}}])}),r("b-table-column",{attrs:{width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"td-buttons"},[r("b-button",{staticClass:"edit",on:{click:function(a){return e.editWebsite(t.index)}}},[r("b-icon",{attrs:{pack:"fas",icon:"pen"}})],1),r("b-button",{staticClass:"delete is-danger",on:{click:function(a){return e.deleteWebsite(t.index)}}},[r("b-icon",{attrs:{pack:"fas",icon:"xmark"}})],1)],1)]}}])})],1)],1)]),r("b-tab-item",{attrs:{label:"夢設"}},[r("div",{staticClass:"myinfo-container"},[r("form",{staticClass:"form",on:{submit:function(t){return t.preventDefault(),e.submitYumejoshi.apply(null,arguments)}}},[r("b-field",{attrs:{label:"✦ 角色名稱","label-for":"yumejoshi-name",message:"最多可輸入 10 個字"}},[r("b-input",{attrs:{id:"yumejoshi-name",placeholder:"請輸入暱稱",maxlength:"10"},model:{value:e.yumejoshi.name,callback:function(t){e.$set(e.yumejoshi,"name",t)},expression:"yumejoshi.name"}})],1),r("b-field",{attrs:{label:"✦ 全身圖/設定圖","label-for":"yumejoshi-image"}},[r("b-upload",{attrs:{id:"yumejoshi-image","drag-drop":"",expanded:""},model:{value:e.yumejoshi.image,callback:function(t){e.$set(e.yumejoshi,"image",t)},expression:"yumejoshi.image"}},[r("section",{staticClass:"section"},[r("div",{staticClass:"content has-text-centered"},[r("p",[r("b-icon",{attrs:{icon:"upload",size:"is-large"}})],1),r("p",[e._v(" 點選或拖曳上傳圖片"),r("br")])])])])],1),e.yumejoshi.image?r("span",{staticClass:"tag is-primary"},[e._v(e._s(e.yumejoshi.image.name))]):e._e(),r("b-field",{attrs:{label:"✦ 角色介紹","label-for":"yumejoshi-introduction"}},[r("b-input",{attrs:{id:"yumejoshi-introduction",type:"textarea",placeholder:"請輸入角色介紹"},model:{value:e.yumejoshi.introduction,callback:function(t){e.$set(e.yumejoshi,"introduction",t)},expression:"yumejoshi.introduction"}})],1),r("input",{staticClass:"button is-success submit",attrs:{type:"submit",value:"儲存設定",disabled:e.submitting}})],1)])]),r("b-tab-item",{attrs:{label:"夢角"}},[r("div",{staticClass:"myinfo-container"},[r("form",{staticClass:"form",on:{submit:function(t){return t.preventDefault(),e.submitCharacter.apply(null,arguments)}}},[r("b-field",{attrs:{label:"✦ 角色名稱","label-for":"character-name",message:"最多可輸入 10 個字"}},[r("b-input",{attrs:{id:"character-name",placeholder:"請輸入暱稱",maxlength:"10"},model:{value:e.character.name,callback:function(t){e.$set(e.character,"name",t)},expression:"character.name"}})],1),r("b-field",{attrs:{label:"✦ 全身圖/設定圖","label-for":"character-image"}},[r("b-upload",{attrs:{id:"character-image","drag-drop":"",expanded:""},model:{value:e.character.image,callback:function(t){e.$set(e.character,"image",t)},expression:"character.image"}},[r("section",{staticClass:"section"},[r("div",{staticClass:"content has-text-centered"},[r("p",[r("b-icon",{attrs:{icon:"upload",size:"is-large"}})],1),r("p",[e._v(" 點選或拖曳上傳圖片"),r("br")])])])])],1),e.character.image?r("span",{staticClass:"tag is-primary"},[e._v(e._s(e.character.image.name))]):e._e(),r("b-field",{attrs:{label:"✦ 角色介紹","label-for":"character-introduction"}},[r("b-input",{attrs:{id:"character-introduction",type:"textarea",placeholder:"請輸入角色介紹"},model:{value:e.character.introduction,callback:function(t){e.$set(e.character,"introduction",t)},expression:"character.introduction"}})],1),r("input",{staticClass:"button is-success submit",attrs:{type:"submit",value:"儲存設定",disabled:e.submitting}})],1)])])],1),r("b-modal",{attrs:{width:"700px",scroll:"keep"},on:{close:e.resetModal},model:{value:e.openModal,callback:function(t){e.openModal=t},expression:"openModal"}},[r("div",{staticClass:"normal-form"},[r("div",{staticClass:"modal-red"},[r("h1",[e._v("新增社群媒體")])]),r("div",{staticClass:"modal-white"},[r("form",{staticClass:"form-group",on:{submit:function(t){return t.preventDefault(),e.submitModal.apply(null,arguments)}}},[r("b-field",[r("b-select",{attrs:{placeholder:"請選擇"},model:{value:e.modal.category,callback:function(t){e.$set(e.modal,"category",t)},expression:"modal.category"}},[r("option",{attrs:{value:"",disabled:""}},[e._v("請選擇")]),r("option",{attrs:{value:"個人網站"}},[e._v("個人網站")]),r("option",{attrs:{value:"pixiv"}},[e._v("pixiv")]),r("option",{attrs:{value:"Plurk"}},[e._v("Plurk")]),r("option",{attrs:{value:"Twitter"}},[e._v("Twitter")]),r("option",{attrs:{value:"Facebook"}},[e._v("Facebook")]),r("option",{attrs:{value:"email"}},[e._v("email")]),r("option",{attrs:{value:"其他"}},[e._v("其他")])])],1),r("b-input",{attrs:{placeholder:"請輸入網址"},model:{value:e.modal.website,callback:function(t){e.$set(e.modal,"website",t)},expression:"modal.website"}}),r("div",{staticClass:"buttons"},[r("b-button",{staticClass:"is-dark",attrs:{disabled:e.modalSubmitting},on:{click:e.resetModal}},[e._v("取消")]),r("input",{staticClass:"button is-success submit",attrs:{type:"submit",value:"送出",disabled:e.modalSubmitting}})],1)],1)])])])],1)},s=[],i=a("5530"),n=a("1da1"),o=(a("a434"),a("b0c0"),a("96cf"),{data:function(){return{openModal:!1,submitting:!1,modalSubmitting:!1,form:{nickname:"",image:null,selfIntroduction:""},modal:{category:"",website:"",_id:"",index:-1},yumejoshi:{name:"",image:null,introduction:"",_id:""},character:{name:"",image:null,introduction:"",_id:""},websites:[]}},methods:{submit:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.preventDefault(),0!==t.form.nickname.length){a.next=4;break}return t.$swal({icon:"error",title:"錯誤",text:"請輸入暱稱"}),a.abrupt("return");case 4:for(s in t.submitting=!0,r=new FormData,t.form)"_id"!==s&&r.append(s,t.form[s]);t.$store.dispatch("user/editInfo",r),t.form=Object(i["a"])(Object(i["a"])({},t.form),{},{image:null}),t.submitting=!1;case 10:case"end":return a.stop()}}),a)})))()},resetModal:function(e){this.modalSubmitting?e.preventDefault():(this.modal={category:"",website:"",_id:"",index:-1},this.openModal=!1)},submitModal:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(0!==t.user.token.length){a.next=4;break}return t.$swal({icon:"error",title:"錯誤",text:"請先登入"}),t.$router.push("/"),a.abrupt("return");case 4:if(e.preventDefault(),0!==t.modal.category.length&&0!==t.modal.website.length){a.next=8;break}return t.$swal({icon:"error",title:"錯誤",text:"缺少必填欄位"}),a.abrupt("return");case 8:if(t.modalSubmitting=!0,a.prev=9,!(t.modal.index<0)){a.next=19;break}return a.next=13,t.api.post("/users/websites",{category:t.modal.category,website:t.modal.website},{headers:{authorization:"Bearer "+t.user.token}});case 13:r=a.sent,s=r.data,t.websites.push(s.result),t.$swal({icon:"success",title:"成功",text:"成功新增社群媒體"}),a.next=24;break;case 19:return a.next=21,t.api.patch("/users/websites",{_id:t.modal._id,category:t.modal.category,website:t.modal.website},{headers:{authorization:"Bearer "+t.user.token}});case 21:t.websites[t.modal.index]=Object(i["a"])({},t.modal),t.$refs.table.resetMultiSorting(),t.$swal({icon:"success",title:"成功",text:"更新成功"});case 24:t.modal={category:"",website:"",index:-1},t.openModal=!1,a.next=31;break;case 28:a.prev=28,a.t0=a["catch"](9),t.$swal({icon:"error",title:"錯誤",text:"失敗"});case 31:t.modalSubmitting=!1;case 32:case"end":return a.stop()}}),a,null,[[9,28]])})))()},editWebsite:function(e){this.modal=Object(i["a"])(Object(i["a"])({},this.websites[e]),{},{index:e}),this.openModal=!0},deleteWebsite:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.api.delete("/users/websites/"+t.websites[e]._id,{headers:{authorization:"Bearer "+t.user.token}});case 3:t.websites.splice(e,1),t.$swal({icon:"success",title:"成功",text:"刪除成功"}),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),t.$swal({icon:"error",title:"錯誤",text:"刪除失敗"});case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()},submitYumejoshi:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,s,n,o,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(0!==t.user.token.length){a.next=4;break}return t.$swal({icon:"error",title:"錯誤",text:"請先登入"}),t.$router.push("/"),a.abrupt("return");case 4:if(e.preventDefault(),0!==t.yumejoshi.name.length){a.next=8;break}return t.$swal({icon:"error",title:"錯誤",text:"角色名稱為必填欄位"}),a.abrupt("return");case 8:if(t.submitting=!0,r=new FormData,a.prev=10,""!==t.yumejoshi._id){a.next=20;break}for(s in t.yumejoshi)"_id"!==s&&r.append(s,t.yumejoshi[s]);return a.next=15,t.api.post("/users/yumejoshi",r,{headers:{authorization:"Bearer "+t.user.token}});case 15:n=a.sent,o=n.data,t.yumejoshi=Object(i["a"])(Object(i["a"])({},t.yumejoshi),{},{image:null,_id:o.result._id}),a.next=24;break;case 20:for(c in t.yumejoshi)r.append(c,t.yumejoshi[c]);return a.next=23,t.api.patch("/users/yumejoshi",r,{headers:{authorization:"Bearer "+t.user.token}});case 23:t.yumejoshi=Object(i["a"])(Object(i["a"])({},t.yumejoshi),{},{image:null});case 24:t.$swal({icon:"success",title:"成功",text:"更新成功"}),a.next=30;break;case 27:a.prev=27,a.t0=a["catch"](10),t.$swal({icon:"error",title:"錯誤",text:"更新失敗"});case 30:t.submitting=!1;case 31:case"end":return a.stop()}}),a,null,[[10,27]])})))()},submitCharacter:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,s,n,o,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(0!==t.user.token.length){a.next=4;break}return t.$swal({icon:"error",title:"錯誤",text:"請先登入"}),t.$router.push("/"),a.abrupt("return");case 4:if(e.preventDefault(),0!==t.character.name.length){a.next=8;break}return t.$swal({icon:"error",title:"錯誤",text:"角色名稱為必填欄位"}),a.abrupt("return");case 8:if(t.submitting=!0,r=new FormData,a.prev=10,""!==t.character._id){a.next=20;break}for(s in t.character)"_id"!==s&&r.append(s,t.character[s]);return a.next=15,t.api.post("/users/character",r,{headers:{authorization:"Bearer "+t.user.token}});case 15:n=a.sent,o=n.data,t.character=Object(i["a"])(Object(i["a"])({},t.character),{},{image:null,_id:o.result._id}),a.next=24;break;case 20:for(c in t.character)r.append(c,t.character[c]);return a.next=23,t.api.patch("/users/character",r,{headers:{authorization:"Bearer "+t.user.token}});case 23:t.character=Object(i["a"])(Object(i["a"])({},t.character),{},{image:null});case 24:t.$swal({icon:"success",title:"成功",text:"更新成功"}),a.next=30;break;case 27:a.prev=27,a.t0=a["catch"](10),t.$swal({icon:"error",title:"錯誤",text:"更新失敗"});case 30:t.submitting=!1;case 31:case"end":return a.stop()}}),a,null,[[10,27]])})))()}},created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==e.user.token.length){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,e.api.get("/users/me",{headers:{authorization:"Bearer "+e.user.token}});case 5:a=t.sent,r=a.data,e.form.nickname=r.result.nickname,e.form.image=null,e.form.selfIntroduction=r.result.selfIntroduction,e.websites=r.result.websites,r.result.yumejoshi.length>0&&(e.yumejoshi._id=r.result.yumejoshi[0]._id,e.yumejoshi.name=r.result.yumejoshi[0].name,e.yumejoshi.introduction=r.result.yumejoshi[0].introduction),r.result.character.length>0&&(e.character._id=r.result.character[0]._id,e.character.name=r.result.character[0].name,e.character.introduction=r.result.character[0].introduction),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](2),e.$swal({icon:"error",title:"錯誤",text:"取得資料失敗"});case 18:case"end":return t.stop()}}),t,null,[[2,15]])})))()}}),c=o,l=a("2877"),u=Object(l["a"])(c,r,s,!1,null,null,null);t["default"]=u.exports},a3df:function(e,t,a){e.exports=a.p+"img/plurk.8bda8ed6.svg"},a434:function(e,t,a){"use strict";var r=a("23e7"),s=a("da84"),i=a("23cb"),n=a("5926"),o=a("07fa"),c=a("7b0b"),l=a("65f0"),u=a("8418"),m=a("1dde"),d=m("splice"),b=s.TypeError,p=Math.max,h=Math.min,f=9007199254740991,g="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var a,r,s,m,d,v,x=c(this),w=o(x),y=i(e,w),k=arguments.length;if(0===k?a=r=0:1===k?(a=0,r=w-y):(a=k-2,r=h(p(n(t),0),w-y)),w+a-r>f)throw b(g);for(s=l(x,r),m=0;m<r;m++)d=y+m,d in x&&u(s,m,x[d]);if(s.length=r,a<r){for(m=y;m<w-r;m++)d=m+r,v=m+a,d in x?x[v]=x[d]:delete x[v];for(m=w;m>w-r+a;m--)delete x[m-1]}else if(a>r)for(m=w-r;m>y;m--)d=m+r-1,v=m+a-1,d in x?x[v]=x[d]:delete x[v];for(m=0;m<a;m++)x[m+y]=arguments[m+2];return x.length=w-r+a,s}})},b0c0:function(e,t,a){var r=a("83ab"),s=a("5e77").EXISTS,i=a("e330"),n=a("9bf2").f,o=Function.prototype,c=i(o.toString),l=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=i(l.exec),m="name";r&&!s&&n(o,m,{configurable:!0,get:function(){try{return u(l,c(this))[1]}catch(e){return""}}})},b1b8:function(e,t,a){e.exports=a.p+"img/twitter-brands.c0bc2186.svg"}}]);
//# sourceMappingURL=usermyinfo.3b25c8fd.js.map