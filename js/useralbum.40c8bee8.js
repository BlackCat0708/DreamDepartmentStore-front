(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["useralbum"],{"1c05":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"useralbum"}},[t._m(0),a("b-tabs",[a("b-tab-item",{attrs:{label:"相簿"}},[a("b-button",{staticClass:"is-success album-button",on:{click:function(e){t.openAlbumModal=!0}}},[t._v("新增")]),a("div",{staticClass:"album-container"},[0===t.album.length?a("p",{staticStyle:{width:"100%","text-align":"center"}},[t._v("請新增作品")]):t._e(),t._l(t.album,(function(e,r){return a("div",{key:e._id,ref:"card",refInFor:!0,staticClass:"col"},[a("div",{staticClass:"image-card"},[a("b-button",{staticClass:"edit",on:{click:function(e){return t.editAlbum(r)}}},[a("b-icon",{attrs:{pack:"fas",icon:"pen"}})],1),a("b-button",{staticClass:"delete is-danger",on:{click:function(e){return t.deleteAlbum(r)}}},[a("b-icon",{attrs:{pack:"fas",icon:"xmark"}})],1),a("img",{attrs:{src:e.image}}),a("div",{staticClass:"album-overlay"},[a("p",{staticClass:"album-illustrator"},[t._v(" "+t._s("繪師 ✦ "+e.illustrator)+" ")])])],1)])}))],2)],1),a("b-tab-item",{attrs:{label:"衣櫃"}},[a("b-button",{staticClass:"is-success album-button",on:{click:function(e){t.openCabinetModal=!0}}},[t._v("新增")]),a("div",{staticClass:"album-container"},[0===t.cabinet.length?a("p",{staticStyle:{width:"100%","text-align":"center"}},[t._v("請新增作品")]):t._e(),t._l(t.cabinet,(function(e,r){return a("div",{key:e._id,staticClass:"col"},[a("div",{staticClass:"image-card"},[a("b-button",{staticClass:"edit",on:{click:function(e){return t.editCabinet(r)}}},[a("b-icon",{attrs:{pack:"fas",icon:"pen"}})],1),a("b-button",{staticClass:"delete is-danger",on:{click:function(e){return t.deleteCabinet(r)}}},[a("b-icon",{attrs:{pack:"fas",icon:"xmark"}})],1),a("img",{attrs:{src:e.image}}),a("div",{staticClass:"album-overlay"},[a("p",{staticClass:"album-illustrator"},[t._v(" "+t._s("繪師 ✦ "+e.illustrator)+" ")])])],1)])}))],2)],1)],1),a("b-modal",{attrs:{width:"700px",scroll:"keep"},on:{close:t.resetModal},model:{value:t.openAlbumModal,callback:function(e){t.openAlbumModal=e},expression:"openAlbumModal"}},[a("div",{staticClass:"normal-form"},[a("div",{staticClass:"modal-red"},[!t.form._id.length>0?a("h1",[t._v("新增相簿圖片")]):t._e(),t.form._id.length>0?a("h1",[t._v("編輯相簿圖片")]):t._e()]),a("div",{staticClass:"modal-white"},[a("form",{staticClass:"form-group",on:{submit:function(e){return e.preventDefault(),t.submitAlbum.apply(null,arguments)}}},[a("b-field",{attrs:{label:"✦ 圖片","label-for":"image"}},[a("b-upload",{attrs:{id:"image","drag-drop":"",expanded:""},model:{value:t.form.image,callback:function(e){t.$set(t.form,"image",e)},expression:"form.image"}},[a("section",{staticClass:"section"},[a("div",{staticClass:"content has-text-centered"},[a("p",[a("b-icon",{attrs:{icon:"upload",size:"is-large"}})],1),a("p",[t._v(" 點選或拖曳上傳圖片"),a("br")])])])])],1),t.form.image?a("span",{staticClass:"tag is-primary"},[t._v(t._s(t.form.image.name))]):t._e(),a("b-field",{attrs:{label:"✦ 繪師","label-for":"character-introduction"}},[a("b-input",{attrs:{id:"character-introduction",placeholder:"請輸入繪師名稱"},model:{value:t.form.illustrator,callback:function(e){t.$set(t.form,"illustrator",e)},expression:"form.illustrator"}})],1),a("div",{staticClass:"buttons"},[a("b-button",{staticClass:"is-dark",attrs:{disabled:t.modalSubmitting},on:{click:t.resetModal}},[t._v("取消")]),a("input",{staticClass:"button is-success submit",attrs:{type:"submit",value:"送出",disabled:t.modalSubmitting}})],1)],1)])])]),a("b-modal",{attrs:{width:"700px",scroll:"keep"},on:{close:t.resetModal},model:{value:t.openCabinetModal,callback:function(e){t.openCabinetModal=e},expression:"openCabinetModal"}},[a("div",{staticClass:"normal-form"},[a("div",{staticClass:"modal-red"},[!t.form._id.length>0?a("h1",[t._v("新增衣櫃圖片")]):t._e(),t.form._id.length>0?a("h1",[t._v("編輯衣櫃圖片")]):t._e()]),a("div",{staticClass:"modal-white"},[a("form",{staticClass:"form-group",on:{submit:function(e){return e.preventDefault(),t.submitCabinet.apply(null,arguments)}}},[a("b-field",{attrs:{label:"✦ 圖片","label-for":"image"}},[a("b-upload",{attrs:{id:"image","drag-drop":"",expanded:""},model:{value:t.form.image,callback:function(e){t.$set(t.form,"image",e)},expression:"form.image"}},[a("section",{staticClass:"section"},[a("div",{staticClass:"content has-text-centered"},[a("p",[a("b-icon",{attrs:{icon:"upload",size:"is-large"}})],1),a("p",[t._v(" 點選或拖曳上傳圖片"),a("br")])])])])],1),t.form.image?a("span",{staticClass:"tag is-primary"},[t._v(t._s(t.form.image.name))]):t._e(),a("b-field",{attrs:{label:"✦ 繪師","label-for":"character-introduction"}},[a("b-input",{attrs:{id:"character-introduction",placeholder:"請輸入繪師名稱"},model:{value:t.form.illustrator,callback:function(e){t.$set(t.form,"illustrator",e)},expression:"form.illustrator"}})],1),a("div",{staticClass:"buttons"},[a("b-button",{staticClass:"is-dark",attrs:{disabled:t.modalSubmitting},on:{click:t.resetModal}},[t._v("取消")]),a("input",{staticClass:"button is-success submit",attrs:{type:"submit",value:"送出",disabled:t.modalSubmitting}})],1)],1)])])])],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-plus"},[a("h1",{staticClass:"management-title"},[t._v("相簿管理")])])}],n=a("5530"),s=a("1da1"),l=(a("a434"),a("96cf"),{data:function(){return{album:[],cabinet:[],openAlbumModal:!1,openCabinetModal:!1,modalSubmitting:!1,form:{image:null,illustrator:"",_id:"",index:-1}}},methods:{submitAlbum:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,i,s,l,o,c,u,m;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(0!==e.user.token.length){a.next=4;break}return e.$swal({icon:"error",title:"錯誤",text:"請先登入"}),e.$router.push("/"),a.abrupt("return");case 4:if(t.preventDefault(),e.modalSubmitting=!0,a.prev=6,0!==e.form._id.length){a.next=21;break}for(i in r=new FormData,e.form)"_id"!==i&&r.append(i,e.form[i]);if(0!==e.form.image.length){a.next=13;break}return e.$swal({icon:"error",title:"錯誤",text:"請上傳圖片檔案"}),a.abrupt("return");case 13:return a.next=15,e.api.post("/users/album",r,{headers:{authorization:"Bearer "+e.user.token}});case 15:s=a.sent,l=s.data,e.album.push(l.result),e.$swal({icon:"success",title:"成功",text:"新增作品成功"}),a.next=29;break;case 21:for(c in o=new FormData,e.form)o.append(c,e.form[c]);return a.next=25,e.api.patch("/users/album",o,{headers:{authorization:"Bearer "+e.user.token}});case 25:u=a.sent,m=u.data,e.album[e.form.index]=Object(n["a"])(Object(n["a"])({},e.form),{},{image:m.result.album[e.form.index].image}),e.$swal({icon:"success",title:"成功",text:"更新成功"});case 29:e.form={image:null,illustrator:"",_id:"",index:-1},e.openAlbumModal=!1,a.next=36;break;case 33:a.prev=33,a.t0=a["catch"](6),e.$swal({icon:"error",title:"錯誤",text:"上傳失敗"});case 36:e.modalSubmitting=!1;case 37:case"end":return a.stop()}}),a,null,[[6,33]])})))()},submitCabinet:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,i,s,l,o,c,u,m;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(0!==e.user.token.length){a.next=4;break}return e.$swal({icon:"error",title:"錯誤",text:"請先登入"}),e.$router.push("/"),a.abrupt("return");case 4:if(t.preventDefault(),e.modalSubmitting=!0,a.prev=6,0!==e.form._id.length){a.next=21;break}for(i in r=new FormData,e.form)"_id"!==i&&r.append(i,e.form[i]);if(0!==e.form.image.length){a.next=13;break}return e.$swal({icon:"error",title:"錯誤",text:"請上傳圖片檔案"}),a.abrupt("return");case 13:return a.next=15,e.api.post("/users/cabinet",r,{headers:{authorization:"Bearer "+e.user.token}});case 15:s=a.sent,l=s.data,e.cabinet.push(l.result),e.$swal({icon:"success",title:"成功",text:"新增作品成功"}),a.next=29;break;case 21:for(c in o=new FormData,e.form)o.append(c,e.form[c]);return a.next=25,e.api.patch("/users/cabinet",o,{headers:{authorization:"Bearer "+e.user.token}});case 25:u=a.sent,m=u.data,e.cabinet[e.form.index]=Object(n["a"])(Object(n["a"])({},e.form),{},{image:m.result.cabinet[e.form.index].image}),e.$swal({icon:"success",title:"成功",text:"更新成功"});case 29:e.form={image:null,illustrator:"",_id:"",index:-1},e.openCabinetModal=!1,a.next=36;break;case 33:a.prev=33,a.t0=a["catch"](6),e.$swal({icon:"error",title:"錯誤",text:"上傳失敗"});case 36:e.modalSubmitting=!1;case 37:case"end":return a.stop()}}),a,null,[[6,33]])})))()},editAlbum:function(t){this.form=Object(n["a"])(Object(n["a"])({},this.album[t]),{},{image:null,index:t}),this.openAlbumModal=!0},editCabinet:function(t){this.form=Object(n["a"])(Object(n["a"])({},this.cabinet[t]),{},{image:null,index:t}),this.openCabinetModal=!0},resetModal:function(t){this.modalSubmitting?t.preventDefault():(this.form={image:null,illustrator:"",_id:"",index:-1},this.openAlbumModal=!1,this.openCabinetModal=!1)},deleteAlbum:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.api.delete("users/album/"+e.album[t]._id,{headers:{authorization:"Bearer "+e.user.token}});case 3:e.album.splice(t,1),e.$swal({icon:"success",title:"成功",text:"刪除成功"}),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),e.$swal({icon:"error",title:"錯誤",text:"刪除失敗"});case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()},deleteCabinet:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.api.delete("users/cabinet/"+e.cabinet[t]._id,{headers:{authorization:"Bearer "+e.user.token}});case 3:e.cabinet.splice(t,1),e.$swal({icon:"success",title:"成功",text:"刪除成功"}),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),e.$swal({icon:"error",title:"錯誤",text:"刪除失敗"});case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()}},created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.user.token.length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,t.api.get("/users/me",{headers:{authorization:"Bearer "+t.user.token}});case 5:a=e.sent,r=a.data,t.album=r.result.album,t.cabinet=r.result.cabinet,e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](2),t.$swal({icon:"error",title:"錯誤",text:"取得資料失敗"});case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))()}}),o=l,c=a("2877"),u=Object(c["a"])(o,r,i,!1,null,null,null);e["default"]=u.exports},a434:function(t,e,a){"use strict";var r=a("23e7"),i=a("da84"),n=a("23cb"),s=a("5926"),l=a("07fa"),o=a("7b0b"),c=a("65f0"),u=a("8418"),m=a("1dde"),d=m("splice"),b=i.TypeError,p=Math.max,f=Math.min,h=9007199254740991,g="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!d},{splice:function(t,e){var a,r,i,m,d,v,x=o(this),k=l(x),C=n(t,k),_=arguments.length;if(0===_?a=r=0:1===_?(a=0,r=k-C):(a=_-2,r=f(p(s(e),0),k-C)),k+a-r>h)throw b(g);for(i=c(x,r),m=0;m<r;m++)d=C+m,d in x&&u(i,m,x[d]);if(i.length=r,a<r){for(m=C;m<k-r;m++)d=m+r,v=m+a,d in x?x[v]=x[d]:delete x[v];for(m=k;m>k-r+a;m--)delete x[m-1]}else if(a>r)for(m=k-r;m>C;m--)d=m+r-1,v=m+a-1,d in x?x[v]=x[d]:delete x[v];for(m=0;m<a;m++)x[m+C]=arguments[m+2];return x.length=k-r+a,i}})}}]);
//# sourceMappingURL=useralbum.40c8bee8.js.map