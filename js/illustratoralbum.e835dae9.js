(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["illustratoralbum"],{a434:function(e,t,a){"use strict";var r=a("23e7"),n=a("da84"),s=a("23cb"),i=a("5926"),l=a("07fa"),o=a("7b0b"),u=a("65f0"),c=a("8418"),d=a("1dde"),m=d("splice"),p=n.TypeError,b=Math.max,f=Math.min,h=9007199254740991,g="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!m},{splice:function(e,t){var a,r,n,d,m,v,w=o(this),x=l(w),k=s(e,x),C=arguments.length;if(0===C?a=r=0:1===C?(a=0,r=x-k):(a=C-2,r=f(b(i(t),0),x-k)),x+a-r>h)throw p(g);for(n=u(w,r),d=0;d<r;d++)m=k+d,m in w&&c(n,d,w[m]);if(n.length=r,a<r){for(d=k;d<x-r;d++)m=d+r,v=d+a,m in w?w[v]=w[m]:delete w[v];for(d=x;d>x-r+a;d--)delete w[d-1]}else if(a>r)for(d=x-r;d>k;d--)m=d+r-1,v=d+a-1,m in w?w[v]=w[m]:delete w[v];for(d=0;d<a;d++)w[d+k]=arguments[d+2];return w.length=x-r+a,n}})},d831:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"illustratoralbum"}},[a("div",{staticClass:"title-plus"},[a("h1",{staticClass:"management-title"},[e._v("相簿管理")]),a("b-button",{staticClass:"is-success",on:{click:function(t){e.openModal=!0}}},[e._v("新增")])],1),a("div",{staticClass:"album-container"},[0===e.album.length?a("p",{staticStyle:{width:"100%","text-align":"center"}},[e._v("請新增作品")]):e._e(),e._l(e.album,(function(t,r){return a("div",{key:t._id,staticClass:"col"},[a("div",{staticClass:"image-card"},[a("b-button",{staticClass:"delete is-danger",on:{click:function(t){return e.deleteImage(r)}}},[a("b-icon",{attrs:{pack:"fas",icon:"xmark"}})],1),a("img",{attrs:{src:t.image}})],1)])}))],2),a("b-modal",{attrs:{width:"700px",scroll:"keep"},on:{close:e.resetModal},model:{value:e.openModal,callback:function(t){e.openModal=t},expression:"openModal"}},[a("div",{staticClass:"normal-form"},[a("div",{staticClass:"modal-red"},[a("h1",[e._v("新增作品")])]),a("div",{staticClass:"modal-white"},[a("form",{staticClass:"form-group",on:{submit:function(t){return t.preventDefault(),e.submitModal.apply(null,arguments)}}},[a("b-field",{attrs:{"label-for":"work"}},[a("b-upload",{attrs:{id:"work","drag-drop":"",expanded:""},model:{value:e.form.image,callback:function(t){e.$set(e.form,"image",t)},expression:"form.image"}},[a("section",{staticClass:"section"},[a("div",{staticClass:"content has-text-centered"},[a("p",[a("b-icon",{attrs:{icon:"upload",size:"is-large"}})],1),a("p",[e._v(" 點選或拖曳上傳圖片"),a("br")])])])])],1),e.form.image?a("span",{staticClass:"tag is-primary"},[e._v(e._s(e.form.image.name))]):e._e(),a("div",{staticClass:"buttons"},[a("b-button",{staticClass:"is-dark",attrs:{disabled:e.modalSubmitting},on:{click:e.resetModal}},[e._v("取消")]),a("input",{staticClass:"button is-success submit",attrs:{type:"submit",value:"送出",disabled:e.modalSubmitting}})],1)],1)])])])],1)},n=[],s=a("1da1"),i=(a("a434"),a("96cf"),{data:function(){return{album:[],openModal:!1,modalSubmitting:!1,form:{image:null}}},methods:{submitModal:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n,s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(0!==t.user.token.length){a.next=4;break}return t.$swal({icon:"error",title:"錯誤",text:"請先登入"}),t.$router.push("/"),a.abrupt("return");case 4:if(e.preventDefault(),0!==t.form.image.length){a.next=8;break}return t.$swal({icon:"error",title:"錯誤",text:"請上傳圖片檔案"}),a.abrupt("return");case 8:for(n in t.modalSubmitting=!0,r=new FormData,t.form)r.append(n,t.form[n]);return a.prev=11,a.next=14,t.api.post("/users/album",r,{headers:{authorization:"Bearer "+t.user.token}});case 14:s=a.sent,i=s.data,t.album.push(i.result),t.$swal({icon:"success",title:"成功",text:"新增作品成功"}),t.form={image:null},t.openModal=!1,a.next=25;break;case 22:a.prev=22,a.t0=a["catch"](11),t.$swal({icon:"error",title:"錯誤",text:"上傳失敗"});case 25:t.modalSubmitting=!1;case 26:case"end":return a.stop()}}),a,null,[[11,22]])})))()},resetModal:function(e){this.modalSubmitting?e.preventDefault():(this.form={image:null},this.openModal=!1)},deleteImage:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.api.delete("users/album/"+t.album[e]._id,{headers:{authorization:"Bearer "+t.user.token}});case 3:t.album.splice(e,1),t.$swal({icon:"success",title:"成功",text:"刪除成功"}),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),t.$swal({icon:"error",title:"錯誤",text:"刪除失敗"});case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()}},created:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==e.user.token.length){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,e.api.get("/users/me",{headers:{authorization:"Bearer "+e.user.token}});case 5:a=t.sent,r=a.data,e.album=r.result.album,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),e.$swal({icon:"error",title:"錯誤",text:"取得資料失敗"});case 13:case"end":return t.stop()}}),t,null,[[2,10]])})))()}}),l=i,o=a("2877"),u=Object(o["a"])(l,r,n,!1,null,null,null);t["default"]=u.exports}}]);
//# sourceMappingURL=illustratoralbum.e835dae9.js.map